package KafkaTesting.demo.Test.Producer;import KafkaTesting.demo.Test.Model.UserEvent;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.kafka.core.KafkaTemplate;import org.springframework.kafka.support.KafkaHeaders;import org.springframework.messaging.Message;import org.springframework.messaging.support.MessageBuilder;import org.springframework.stereotype.Service;@Servicepublic class KafkaProducer {    @Autowired    private  KafkaTemplate<String, UserEvent> kafkaTemplate;    public KafkaProducer(KafkaTemplate<String, UserEvent> kafkaTemplate) {        this.kafkaTemplate = kafkaTemplate;    }    public void sendEvent(String key, UserEvent event) {        //kafkaTemplate.send("topic_Beni",key,event);        Message<UserEvent> build = MessageBuilder.withPayload(event).setHeader(KafkaHeaders.TOPIC, "topic_Beni").                setHeader(KafkaHeaders.KEY,key).build();        kafkaTemplate.send(build);        System.out.println("Sent: " + event);    }}